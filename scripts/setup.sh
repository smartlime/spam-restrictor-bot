#!/bin/bash

# –°–∫—Ä–∏–ø—Ç –¥–ª—è –ø–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞

echo "üõ°Ô∏è  –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Spam Restrictor Bot"
echo "=================================="

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è Docker
if ! command -v docker &> /dev/null; then
    echo "‚ùå Docker –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Docker –∏ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞."
    exit 1
fi

if ! command -v docker-compose &> /dev/null; then
    echo "‚ùå Docker Compose –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Docker Compose –∏ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞."
    exit 1
fi

echo "‚úÖ Docker –∏ Docker Compose –æ–±–Ω–∞—Ä—É–∂–µ–Ω—ã"

# –°–æ–∑–¥–∞–Ω–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π –¥–ª—è –¥–∞–Ω–Ω—ã—Ö
echo ""
echo "üìÅ –°–æ–∑–¥–∞–Ω–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π..."
mkdir -p data
mkdir -p data-dev
echo "‚úÖ –î–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ —Å–æ–∑–¥–∞–Ω—ã"

# –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ —Ñ–∞–π–ª–∞
echo ""
if [ ! -f "config.yml" ]; then
    echo "üìù –°–æ–∑–¥–∞–Ω–∏–µ config.yml –∏–∑ –ø—Ä–∏–º–µ—Ä–∞..."
    cp config.example.yml config.yml
    echo "‚úÖ –§–∞–π–ª config.yml —Å–æ–∑–¥–∞–Ω"
    echo ""
    echo "‚ö†Ô∏è  –í–ê–ñ–ù–û: –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ config.yml –∏ —É–∫–∞–∂–∏—Ç–µ:"
    echo "   - –¢–æ–∫–µ–Ω –±–æ—Ç–∞ (bot_token)"
    echo "   - ID –≥—Ä—É–ø–ø—ã (group_id)"
else
    echo "‚ÑπÔ∏è  config.yml —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –ø—Ä–æ–ø—É—Å–∫–∞–µ–º"
fi

# –°–æ–∑–¥–∞–Ω–∏–µ dev –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
echo ""
if [ ! -f "config.dev.yml" ]; then
    echo "üìù –°–æ–∑–¥–∞–Ω–∏–µ config.dev.yml –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏..."
    cp config.example.yml config.dev.yml
    echo "‚úÖ –§–∞–π–ª config.dev.yml —Å–æ–∑–¥–∞–Ω"
    echo ""
    echo "‚ö†Ô∏è  –í–ê–ñ–ù–û: –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ config.dev.yml –¥–ª—è —Ç–µ—Å—Ç–æ–≤–æ–π –≥—Ä—É–ø–ø—ã"
else
    echo "‚ÑπÔ∏è  config.dev.yml —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –ø—Ä–æ–ø—É—Å–∫–∞–µ–º"
fi

echo ""
echo "‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞!"
echo ""
echo "üìã –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:"
echo "   1. –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ config.yml (—É–∫–∞–∂–∏—Ç–µ —Ç–æ–∫–µ–Ω –±–æ—Ç–∞ –∏ ID –≥—Ä—É–ø–ø—ã)"
echo "   2. –î–æ–±–∞–≤—å—Ç–µ –±–æ—Ç–∞ –≤ –≥—Ä—É–ø–ø—É –∫–∞–∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞"
echo "   3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ: make build && make up"
echo "   4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: make logs"
echo ""
echo "üìñ –ü–æ–¥—Ä–æ–±–Ω–µ–µ —Å–º. README.md"
